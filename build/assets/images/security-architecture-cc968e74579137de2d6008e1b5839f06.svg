<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="900" height="700" xmlns="http://www.w3.org/2000/svg">
  <!-- Background rectangle -->
  <rect width="900" height="700" fill="#f8f9fa" />

  <!-- Title - moved much lower -->
  <text x="450" y="55" font-family="sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333333">Three Horizons Platform - Security Architecture (v1.0, April 2025)</text>

  <!-- Zero Trust Banner - position preserved -->
  <rect x="150" y="70" width="600" height="30" rx="5" fill="#222222" />
  <text x="450" y="90" font-family="sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="white">Zero Trust Security Model</text>

  <!-- Platform Icons - adjusted positions further to the right -->
  <circle cx="770" cy="85" r="15" fill="#0078d4" />
  <text x="770" y="89" font-size="12" fill="white" text-anchor="middle">A</text>
  
  <circle cx="810" cy="85" r="15" fill="#ee0000" />
  <text x="810" y="89" font-size="12" fill="white" text-anchor="middle">R</text>
  
  <circle cx="850" cy="85" r="15" fill="#6f42c1" />
  <text x="850" y="89" font-size="12" fill="white" text-anchor="middle">G</text>

  <!-- Side borders with labels -->
  <rect x="120" y="100" width="20" height="500" fill="#e9ecef" />
  
  <!-- Left border text with modified position -->
  <g transform="translate(130, 350)">
    <text transform="rotate(270)" font-family="sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#666666">
      <tspan x="0" y="0">Trusted Security Boundary</tspan>
    </text>
  </g>
  
  <rect x="760" y="100" width="20" height="500" fill="#e9ecef" />
  
  <!-- Right border text with modified position -->
  <g transform="translate(770, 350)">
    <text transform="rotate(270)" font-family="sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#666666">
      <tspan x="0" y="0">Trusted Security Boundary</tspan>
    </text>
  </g>

  <!-- Identity and Access Management Layer -->
  <rect x="150" y="100" width="600" height="100" fill="#cfe2ff" rx="5" />
  <text x="450" y="125" font-family="sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333333">Identity and Access Management</text>

  <!-- Network Security Layer -->
  <rect x="150" y="210" width="600" height="100" fill="#fff3cd" rx="5" />
  <text x="450" y="235" font-family="sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333333">Network Security</text>

  <!-- Platform Security Layer -->
  <rect x="150" y="320" width="600" height="100" fill="#e2d9f3" rx="5" />
  <text x="450" y="345" font-family="sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333333">Platform Security</text>

  <!-- Data Security Layer -->
  <rect x="150" y="430" width="600" height="100" fill="#d1e7dd" rx="5" />
  <text x="450" y="455" font-family="sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333333">Data Security</text>

  <!-- Monitoring and Auditing Layer -->
  <rect x="150" y="540" width="600" height="100" fill="#f8d7da" rx="5" />
  <text x="450" y="565" font-family="sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#333333">Monitoring and Auditing</text>

  <!-- Components for Identity Layer -->
  <rect x="170" y="140" width="135" height="50" fill="white" stroke="#0078d4" stroke-width="2" rx="3" />
  <text x="175" y="155" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Microsoft Entra ID</text>
  <text x="175" y="170" font-family="sans-serif" font-size="10" fill="#333333">Identity Provider</text>
  <text x="175" y="185" font-family="sans-serif" font-size="10" fill="#333333">SSO &amp; Conditional Access</text>

  <rect x="315" y="140" width="135" height="50" fill="white" stroke="#0078d4" stroke-width="2" rx="3" />
  <text x="320" y="155" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Managed Identities</text>
  <text x="320" y="170" font-family="sans-serif" font-size="10" fill="#333333">Service Authentication</text>
  <text x="320" y="185" font-family="sans-serif" font-size="10" fill="#333333">No Credential Management</text>

  <rect x="460" y="140" width="135" height="50" fill="white" stroke="#0078d4" stroke-width="2" rx="3" />
  <text x="465" y="155" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Workload Identity</text>
  <text x="465" y="170" font-family="sans-serif" font-size="10" fill="#333333">Federated Credentials</text>
  <text x="465" y="185" font-family="sans-serif" font-size="10" fill="#333333">OIDC Token Exchange</text>

  <rect x="605" y="140" width="135" height="50" fill="white" stroke="#0078d4" stroke-width="2" rx="3" />
  <text x="610" y="155" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Multi-Factor Auth</text>
  <text x="610" y="170" font-family="sans-serif" font-size="10" fill="#333333">Strong Authentication</text>
  <text x="610" y="185" font-family="sans-serif" font-size="10" fill="#333333">Passwordless Options</text>

  <!-- Components for Network Layer -->
  <rect x="170" y="250" width="135" height="50" fill="white" stroke="#ffc107" stroke-width="2" rx="3" />
  <text x="175" y="265" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">NSGs/Firewall</text>
  <text x="175" y="280" font-family="sans-serif" font-size="10" fill="#333333">Traffic Filtering</text>
  <text x="175" y="295" font-family="sans-serif" font-size="10" fill="#333333">Azure Firewall Policy</text>

  <rect x="315" y="250" width="135" height="50" fill="white" stroke="#ffc107" stroke-width="2" rx="3" />
  <text x="320" y="265" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Private Endpoints</text>
  <text x="320" y="280" font-family="sans-serif" font-size="10" fill="#333333">PaaS Service Protection</text>
  <text x="320" y="295" font-family="sans-serif" font-size="10" fill="#333333">No Public Internet Access</text>

  <rect x="460" y="250" width="135" height="50" fill="white" stroke="#ffc107" stroke-width="2" rx="3" />
  <text x="465" y="265" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Network Policies</text>
  <text x="465" y="280" font-family="sans-serif" font-size="10" fill="#333333">Pod Traffic Control</text>
  <text x="465" y="295" font-family="sans-serif" font-size="10" fill="#333333">Micro-segmentation</text>

  <rect x="605" y="250" width="135" height="50" fill="white" stroke="#ffc107" stroke-width="2" rx="3" />
  <text x="610" y="265" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">TLS &amp; mTLS</text>
  <text x="610" y="280" font-family="sans-serif" font-size="10" fill="#333333">Encrypted Transit</text>
  <text x="610" y="295" font-family="sans-serif" font-size="10" fill="#333333">Service Authentication</text>

  <!-- Components for Platform Layer -->
  <rect x="170" y="360" width="135" height="50" fill="white" stroke="#6f42c1" stroke-width="2" rx="3" />
  <text x="175" y="375" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">AKS/ARO Security</text>
  <text x="175" y="390" font-family="sans-serif" font-size="10" fill="#333333">Microsoft Defender</text>
  <text x="175" y="405" font-family="sans-serif" font-size="10" fill="#333333">Host Security</text>

  <rect x="315" y="360" width="135" height="50" fill="white" stroke="#6f42c1" stroke-width="2" rx="3" />
  <text x="320" y="375" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">K8s RBAC &amp; Pod Security</text>
  <text x="320" y="390" font-family="sans-serif" font-size="10" fill="#333333">Role-Based Access</text>
  <text x="320" y="405" font-family="sans-serif" font-size="10" fill="#333333">Pod Security Standards</text>

  <rect x="460" y="360" width="135" height="50" fill="white" stroke="#6f42c1" stroke-width="2" rx="3" />
  <text x="465" y="375" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">GitHub Adv. Security</text>
  <text x="465" y="390" font-family="sans-serif" font-size="10" fill="#333333">Code Scanning</text>
  <text x="465" y="405" font-family="sans-serif" font-size="10" fill="#333333">Secret Detection</text>

  <rect x="605" y="360" width="135" height="50" fill="white" stroke="#6f42c1" stroke-width="2" rx="3" />
  <text x="610" y="375" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">OPA/Gatekeeper</text>
  <text x="610" y="390" font-family="sans-serif" font-size="10" fill="#333333">Policy Enforcement</text>
  <text x="610" y="405" font-family="sans-serif" font-size="10" fill="#333333">Admission Control</text>

  <!-- Components for Data Layer -->
  <rect x="170" y="470" width="135" height="50" fill="white" stroke="#198754" stroke-width="2" rx="3" />
  <text x="175" y="485" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Key Vault</text>
  <text x="175" y="500" font-family="sans-serif" font-size="10" fill="#333333">Secrets Management</text>
  <text x="175" y="515" font-family="sans-serif" font-size="10" fill="#333333">Centralized Key Storage</text>

  <rect x="315" y="470" width="135" height="50" fill="white" stroke="#198754" stroke-width="2" rx="3" />
  <text x="320" y="485" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Encrypted Storage</text>
  <text x="320" y="500" font-family="sans-serif" font-size="10" fill="#333333">Azure Storage</text>
  <text x="320" y="515" font-family="sans-serif" font-size="10" fill="#333333">PostgreSQL Encryption</text>

  <rect x="460" y="470" width="135" height="50" fill="white" stroke="#198754" stroke-width="2" rx="3" />
  <text x="465" y="485" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Image Scanning</text>
  <text x="465" y="500" font-family="sans-serif" font-size="10" fill="#333333">Container Vulnerability</text>
  <text x="465" y="515" font-family="sans-serif" font-size="10" fill="#333333">Build-time Scanning</text>

  <rect x="605" y="470" width="135" height="50" fill="white" stroke="#198754" stroke-width="2" rx="3" />
  <text x="610" y="485" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Data Classification</text>
  <text x="610" y="500" font-family="sans-serif" font-size="10" fill="#333333">Sensitive Data Protection</text>
  <text x="610" y="515" font-family="sans-serif" font-size="10" fill="#333333">Information Protection</text>

  <!-- Components for Monitoring Layer -->
  <rect x="170" y="580" width="135" height="50" fill="white" stroke="#dc3545" stroke-width="2" rx="3" />
  <text x="175" y="595" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Azure Monitor</text>
  <text x="175" y="610" font-family="sans-serif" font-size="10" fill="#333333">Log Analytics</text>
  <text x="175" y="625" font-family="sans-serif" font-size="10" fill="#333333">Unified Monitoring</text>

  <rect x="315" y="580" width="135" height="50" fill="white" stroke="#dc3545" stroke-width="2" rx="3" />
  <text x="320" y="595" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Prometheus &amp; Grafana</text>
  <text x="320" y="610" font-family="sans-serif" font-size="10" fill="#333333">Metric Collection</text>
  <text x="320" y="625" font-family="sans-serif" font-size="10" fill="#333333">Visualization</text>

  <rect x="460" y="580" width="135" height="50" fill="white" stroke="#dc3545" stroke-width="2" rx="3" />
  <text x="465" y="595" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Defender for Cloud</text>
  <text x="465" y="610" font-family="sans-serif" font-size="10" fill="#333333">Threat Protection</text>
  <text x="465" y="625" font-family="sans-serif" font-size="10" fill="#333333">Security Posture</text>

  <rect x="605" y="580" width="135" height="50" fill="white" stroke="#dc3545" stroke-width="2" rx="3" />
  <text x="610" y="595" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">SIEM</text>
  <text x="610" y="610" font-family="sans-serif" font-size="10" fill="#333333">Security Event Management</text>
  <text x="610" y="625" font-family="sans-serif" font-size="10" fill="#333333">Incident Response</text>

  <!-- Connecting Lines -->
  <line x1="232" y1="190" x2="232" y2="250" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="377" y1="190" x2="377" y2="250" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="522" y1="190" x2="522" y2="250" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="667" y1="190" x2="667" y2="250" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />

  <line x1="232" y1="300" x2="232" y2="360" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="377" y1="300" x2="377" y2="360" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="522" y1="300" x2="522" y2="360" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="667" y1="300" x2="667" y2="360" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />

  <line x1="232" y1="410" x2="232" y2="470" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="377" y1="410" x2="377" y2="470" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="522" y1="410" x2="522" y2="470" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="667" y1="410" x2="667" y2="470" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />

  <line x1="232" y1="520" x2="232" y2="580" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="377" y1="520" x2="377" y2="580" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="522" y1="520" x2="522" y2="580" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />
  <line x1="667" y1="520" x2="667" y2="580" stroke="#666" stroke-width="1" stroke-dasharray="5,3" />

  <!-- Legend -->
  <rect x="170" y="640" width="180" height="50" fill="white" stroke="#dee2e6" stroke-width="1" rx="3" />
  <text x="175" y="655" font-family="sans-serif" font-size="12" font-weight="bold" fill="#333333">Security Layers</text>
  
  <circle cx="180" cy="670" r="5" fill="#cfe2ff" />
  <text x="190" y="673" font-family="sans-serif" font-size="10" fill="#333333">Identity and Access</text>
  
  <circle cx="180" cy="685" r="5" fill="#fff3cd" />
  <text x="190" y="688" font-family="sans-serif" font-size="10" fill="#333333">Network</text>
  
  <circle cx="290" cy="670" r="5" fill="#e2d9f3" />
  <text x="300" y="673" font-family="sans-serif" font-size="10" fill="#333333">Platform</text>
  
  <circle cx="290" cy="685" r="5" fill="#d1e7dd" />
  <text x="300" y="688" font-family="sans-serif" font-size="10" fill="#333333">Data</text>
  
  <!-- Compliance Pills - Repositioned -->
  <rect x="380" y="640" width="80" height="20" rx="10" fill="#0078d4" />
  <text x="420" y="653" font-family="sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">PCI DSS</text>
  
  <rect x="470" y="640" width="80" height="20" rx="10" fill="#6f42c1" />
  <text x="510" y="653" font-family="sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">HIPAA</text>
  
  <rect x="560" y="640" width="80" height="20" rx="10" fill="#198754" />
  <text x="600" y="653" font-family="sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">SOC2</text>
  
  <rect x="650" y="640" width="80" height="20" rx="10" fill="#dc3545" />
  <text x="690" y="653" font-family="sans-serif" font-size="10" font-weight="bold" fill="white" text-anchor="middle">ISO 27001</text>
  
  <!-- Platform Legend - Repositioned -->
  <rect x="380" y="670" width="350" height="20" fill="white" stroke="#dee2e6" stroke-width="1" rx="3" />
  <text x="390" y="683" font-family="sans-serif" font-size="10" fill="#333333">A: Azure</text>
  <text x="470" y="683" font-family="sans-serif" font-size="10" fill="#333333">R: Red Hat</text>
  <text x="550" y="683" font-family="sans-serif" font-size="10" fill="#333333">G: GitHub</text>
</svg> 